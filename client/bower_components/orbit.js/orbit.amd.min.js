define("orbit",["orbit/main","orbit/action-queue","orbit/document","orbit/evented","orbit/notifier","orbit/requestable","orbit/request-connector","orbit/transaction","orbit/transformable","orbit/transform-connector","orbit/lib/assert","orbit/lib/config","orbit/lib/diffs","orbit/lib/eq","orbit/lib/exceptions","orbit/lib/objects","orbit/lib/strings","orbit/lib/stubs","orbit/lib/uuid","exports"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){"use strict";var u=a["default"],v=b["default"],w=c["default"],x=d["default"],y=e["default"],z=f["default"],A=g["default"],B=h["default"],C=i["default"],D=j["default"],E=k.assert,F=l.arrayToOptions,G=m.diffs,H=n.eq,I=o.Exception,J=o.PathNotFoundException,K=p.Class,L=p.clone,M=p.defineClass,N=p.expose,O=p.extend,P=p.extendClass,Q=p.isArray,R=p.isNone,S=q.capitalize,T=r.noop,U=r.required,V=s.uuid;u.ActionQueue=v,u.Document=w,u.Evented=x,u.Notifier=y,u.Requestable=z,u.RequestConnector=A,u.Transaction=B,u.Transformable=C,u.TransformConnector=D,u.assert=E,u.arrayToOptions=F,u.diffs=G,u.eq=H,u.Exception=I,u.PathNotFoundException=J,u.Class=K,u.clone=L,u.defineClass=M,u.expose=N,u.extend=O,u.extendClass=P,u.isArray=Q,u.isNone=R,u.capitalize=S,u.noop=T,u.required=U,u.uuid=V,t["default"]=u}),define("orbit/action-queue",["./main","./evented","./lib/assert","./lib/objects","exports"],function(a,b,c,d,e){"use strict";var f=a["default"],g=b["default"],h=c.assert,i=d.Class,j=i.extend({init:function(a,b,c){h("ActionQueue requires Orbit.Promise to be defined",f.Promise),g.extend(this),this.fn=a,this.context=b||this,c=c||{},this.autoProcess=void 0!==c.autoProcess?c.autoProcess:!0,this._queue=[],this.processing=!1},push:function(){var a=this,b=arguments,c=new f.Promise(function(c){var d=function(){var d=a.fn.apply(a.context,b);return d?d.then(function(){c()}):void c()};a._queue.push(d)});return this.autoProcess&&this.process(),c},process:function(){if(!this.processing){var a=this;a.processing=!0;var b=function(){if(0===a._queue.length)a.processing=!1,a.emit("didComplete");else{var c=a._queue.shift(),d=c.call(a);if(d)return d.then(function(){b()},function(){b()});b()}};b()}},then:function(a,b){var c=this;return new f.Promise(function(a){c.processing?c.one("didComplete",function(){a()}):a()}).then(a,b)}});e["default"]=j}),define("orbit/document",["./lib/objects","./lib/diffs","./lib/eq","./lib/exceptions","exports"],function(a,b,c,d,e){"use strict";var f=a.Class,g=a.clone,h=a.isArray,i=(b.diffs,c.eq),j=d.PathNotFoundException,k=f.extend({init:function(a,b){b=b||{},this.arrayBasedPaths=void 0!==b.arrayBasedPaths?b.arrayBasedPaths:!1,this.reset(a)},reset:function(a){this._data=a||{}},retrieve:function(a){return this._retrieve(this.deserializePath(a))},add:function(a,b,c){return this._add(this.deserializePath(a),b,c)},remove:function(a,b){return this._remove(this.deserializePath(a),b)},replace:function(a,b,c){return this._replace(this.deserializePath(a),b,c)},move:function(a,b,c){return this._move(this.deserializePath(a),this.deserializePath(b),c)},copy:function(a,b,c){return this._copy(this.deserializePath(a),this.deserializePath(b),c)},test:function(a,b){return i(this._retrieve(this.deserializePath(a)),b)},transform:function(a,b){return"add"===a.op?this.add(a.path,a.value,b):"remove"===a.op?this.remove(a.path,b):"replace"===a.op?this.replace(a.path,a.value,b):"move"===a.op?this.move(a.from,a.path,b):"copy"===a.op?this.copy(a.from,a.path,b):"test"===a.op?this.copy(a.path,a.value):void 0},serializePath:function(a){return this.arrayBasedPaths?a:0===a.length?"/":"/"+a.join("/")},deserializePath:function(a){return"string"==typeof a?(0===a.indexOf("/")&&(a=a.substr(1)),0===a.length?[]:a.split("/")):a},_pathNotFound:function(a){throw new j(this.serializePath(a))},_retrieve:function(a){var b,c=this._data;if(a)for(var d=0,e=a.length;e>d;d++)b=a[d],c=h(c)?"-"===b?c[c.length-1]:c[parseInt(b,10)]:c[b],void 0===c&&this._pathNotFound(a);return c},_add:function(a,b,c){var d;if(b=g(b),a.length>0){var e=a[a.length-1];if(a.length>1){var f=this._retrieve(a.slice(0,-1));if(h(f))if("-"===e)c&&(d=[{op:"remove",path:this.serializePath(a)}]),f.push(b);else{var i=parseInt(e,10);i>f.length?this._pathNotFound(a):(c&&(d=[{op:"remove",path:this.serializePath(a)}]),f.splice(i,0,b))}else c&&(d=f.hasOwnProperty(e)?[{op:"replace",path:this.serializePath(a),value:g(f[e])}]:[{op:"remove",path:this.serializePath(a)}]),f[e]=b}else c&&(d=this._data.hasOwnProperty(e)?[{op:"replace",path:this.serializePath(a),value:g(this._data[e])}]:[{op:"remove",path:this.serializePath(a)}]),this._data[e]=b}else c&&(d=[{op:"replace",path:this.serializePath([]),value:g(this._data)}]),this._data=b;return d},_remove:function(a,b){var c;if(a.length>0){var d=a[a.length-1];if(a.length>1){var e=this._retrieve(a.slice(0,-1));if(h(e))if(e.length>0)if("-"===d)b?c=[{op:"add",path:this.serializePath(a),value:g(e.pop())}]:e.pop();else{var f=parseInt(d,10);void 0===e[f]?this._pathNotFound(a):b?c=[{op:"add",path:this.serializePath(a),value:g(e.splice(f,1)[0])}]:e.splice(f,1)}else this._pathNotFound(a);else void 0===e[d]?this._pathNotFound(a):(b&&(c=[{op:"add",path:this.serializePath(a),value:g(e[d])}]),delete e[d])}else void 0===this._data[d]?this._pathNotFound(a):(b&&(c=[{op:"add",path:this.serializePath(a),value:g(this._data[d])}]),delete this._data[d])}else b&&(c=[{op:"add",path:this.serializePath(a),value:g(this._data)}]),this._data={};return c},_replace:function(a,b,c){var d;if(b=g(b),a.length>0){var e=a[a.length-1];if(a.length>1){var f=this._retrieve(a.slice(0,-1));if(h(f))if(f.length>0)if("-"===e)c&&(d=[{op:"replace",path:this.serializePath(a),value:g(f[f.length-1])}]),f[f.length-1]=b;else{var i=parseInt(e,10);void 0===f[i]?this._pathNotFound(a):c?d=[{op:"replace",path:this.serializePath(a),value:g(f.splice(i,1,b)[0])}]:f.splice(i,1,b)}else this._pathNotFound(a);else void 0===f[e]?this._pathNotFound(a):(c&&(d=[{op:"replace",path:this.serializePath(a),value:g(f[e])}]),f[e]=b)}else void 0===this._data[e]?this._pathNotFound(a):(c&&(d=[{op:"replace",path:this.serializePath(a),value:g(this._data[e])}]),this._data[e]=b)}else c&&(d=[{op:"replace",path:this.serializePath([]),value:g(this._data)}]),this._data=b;return d},_move:function(a,b,c){if(!i(a,b)){var d=this._retrieve(a);return c?this._remove(a,!0).concat(this._add(b,d,!0)).reverse():(this._remove(a),void this._add(b,d))}return c?[]:void 0},_copy:function(a,b,c){return i(a,b)?c?[]:void 0:this._add(b,this._retrieve(a),c)}});e["default"]=k}),define("orbit/evented",["./main","./notifier","./lib/assert","./lib/objects","exports"],function(a,b,c,d,e){"use strict";var f=a["default"],g=b["default"],h=c.assert,i=d.extend,j=function(a,b,c){var d=a._eventedNotifiers[b];return!d&&c&&(d=a._eventedNotifiers[b]=new g),d},k=function(a,b){delete a._eventedNotifiers[b]},l={extend:function(a){return h("Evented requires Orbit.Promise be defined",f.Promise),void 0===a._evented&&(i(a,this.interface),a._eventedNotifiers={}),a},"interface":{_evented:!0,on:function(a,b,c){c=c||this,a.split(/\s+/).forEach(function(a){j(this,a,!0).addListener(b,c)},this)},off:function(a,b,c){var d;c=c||this,a.split(/\s+/).forEach(function(a){d=j(this,a),d&&(b?d.removeListener(b,c):k(this,a))},this)},one:function(a,b,c){var d,e;c=c||this,e=j(this,a,!0),d=function(){b.apply(c,arguments),e.removeListener(d,c)},e.addListener(d,c)},emit:function(a){var b,c=Array.prototype.slice.call(arguments,1);a.split(/\s+/).forEach(function(a){b=j(this,a),b&&b.emit.apply(b,c)},this)},poll:function(a){var b,c=Array.prototype.slice.call(arguments,1),d=[];return a.split(/\s+/).forEach(function(a){b=j(this,a),b&&(d=d.concat(b.poll.apply(b,c)))},this),d},listeners:function(a){var b,c=[];return a.split(/\s+/).forEach(function(a){b=j(this,a),b&&(c=c.concat(b.listeners))},this),c},resolve:function(a){var b=this.listeners(a),c=Array.prototype.slice.call(arguments,1);return new f.Promise(function(a,d){var e=function(){if(0===b.length)d();else{var f=b.shift(),g=f[0].apply(f[1],c);g?g.then(function(b){a(b)},function(){e()}):e()}};e()})},settle:function(a){var b=this.listeners(a),c=Array.prototype.slice.call(arguments,1);return new f.Promise(function(a){var d=function(){if(0===b.length)a();else{var e=b.shift(),f=e[0].apply(e[1],c);if(f)return f.then(function(){d()},function(){d()});d()}};d()})}}};e["default"]=l}),define("orbit/lib/assert",["exports"],function(a){"use strict";var b=function(a,b){if(!b)throw new Error("Assertion failed: "+a)};a.assert=b}),define("orbit/lib/config",["exports"],function(a){"use strict";var b=function(a){var b={};if(a)for(var c in a)a.hasOwnProperty(c)&&(b[a[c]]=!0);return b};a.arrayToOptions=b}),define("orbit/lib/diffs",["./eq","./objects","./config","exports"],function(a,b,c,d){"use strict";var e=a.eq,f=b.clone,g=b.isArray,h=c.arrayToOptions,i=function(a,b,c){if(a===b)return void 0;c=c||{};var d=h(c.ignore),j=c.basePath||"";g(j)&&(j=j.join("/"));var k=Object.prototype.toString.call(a);if(k===Object.prototype.toString.call(b)){if(null!==a&&"object"==typeof a){var l,m;if(g(a)){var n,o,p=a.length,q=b.length,r=q>p?q:p,s=0,t=0;for(l=0;r>l;l++)if(s>=p)void 0===m&&(m=[]),m.push({op:"add",path:j+"/"+t,value:f(b[t])}),t++;else if(t>=q)void 0===m&&(m=[]),m.push({op:"remove",path:j+"/"+s}),s++;else if(e(a[s],b[t]))s++,t++;else{for(n=-1,o=t+1;q>o;o++)if(e(a[s],b[o])){n=o;break}-1===n?(void 0===m&&(m=[]),m.push({op:"remove",path:j+"/"+s}),s++):(void 0===m&&(m=[]),m.push({op:"add",path:j+"/"+t,value:f(b[t])}),t++)}}else{for(l in b)!d[l]&&b.hasOwnProperty(l)&&(void 0===a[l]?(void 0===m&&(m=[]),m.push({op:"add",path:j+"/"+l,value:f(b[l])})):e(a[l],b[l])||(void 0===m&&(m=[]),m=m.concat(i(a[l],b[l],{basePath:j+"/"+l}))));for(l in a)!d[l]&&a.hasOwnProperty(l)&&void 0===b[l]&&(void 0===m&&(m=[]),m.push({op:"remove",path:j+"/"+l}))}return m}if(e(a,b))return void 0}return[{op:"replace",path:j,value:f(b)}]};d.diffs=i}),define("orbit/lib/eq",["exports"],function(a){"use strict";var b=function(a,c){if(a===c)return 0!==a||1/a==1/c;if(null==a||null==c)return a===c;var d=Object.prototype.toString.call(a);if(d!==Object.prototype.toString.call(c))return!1;switch(d){case"[object String]":return a==String(c);case"[object Number]":return a!=+a?c!=+c:0==a?1/a==1/c:a==+c;case"[object Date]":case"[object Boolean]":return+a==+c;case"[object RegExp]":return a.source==c.source&&a.global==c.global&&a.multiline==c.multiline&&a.ignoreCase==c.ignoreCase}if("object"!=typeof a||"object"!=typeof c)return!1;if("[object Array]"===d&&a.length!==c.length)return!1;var e;for(e in c)if(c.hasOwnProperty(e)&&!b(a[e],c[e]))return!1;for(e in a)if(a.hasOwnProperty(e)&&!b(a[e],c[e]))return!1;return!0};a.eq=b}),define("orbit/lib/exceptions",["./objects","exports"],function(a,b){"use strict";var c=a.Class,d=c.extend(),e=d.extend({init:function(a){this.path=a}});b.Exception=d,b.PathNotFoundException=e}),define("orbit/lib/objects",["./eq","exports"],function(a,b){"use strict";var c=(a.eq,function(a){if(void 0===a||null===a||"object"!=typeof a)return a;var b,d=Object.prototype.toString.call(a);if("[object Date]"===d)b=new Date,b.setTime(a.getTime());else if("[object RegExp]"===d)b=a.constructor(a);else if("[object Array]"===d){b=[];for(var e=0,f=a.length;f>e;e++)a.hasOwnProperty(e)&&b.push(c(a[e]))}else{var g;b={};for(var h in a)a.hasOwnProperty(h)&&(g=a[h],"object"==typeof g&&(g=c(g)),b[h]=g)}return b}),d=function(a,b){var c;c=arguments.length>2?Array.prototype.slice.call(arguments,2):Object.keys(b),c.forEach(function(c){a[c]="function"==typeof b[c]?function(){return b[c].apply(b,arguments)}:b[c]})},e=function(a){var b=Array.prototype.slice.call(arguments,1);b.forEach(function(b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})},f=function(a){var b=Array.prototype.slice.call(arguments,1);b.forEach(function(b){for(var c in b)a[c]=b.hasOwnProperty(c)&&a[c]&&"function"==typeof a[c]&&"function"==typeof b[c]?function(a,b){var c=function(){var c=this._super;this._super=a;var d=b.apply(this,arguments);return this._super=c,d};return c.wrappedFunction=b,c}(a[c],b[c]):b[c]})},g=!1,h=function(a){var b=function(){!g&&this.init&&this.init.apply(this,arguments)};if(a&&(g=!0,b.prototype=new a,g=!1),arguments.length>1){var c=Array.prototype.slice.call(arguments,1);c.unshift(b.prototype),f.apply(b.prototype,c)}return b.constructor=b,b.extend=function(){var a=Array.prototype.slice.call(arguments,0);return a.unshift(b),h.apply(b,a)},b},i=h(null,{init:function(){}}),j=function(a){return"[object Array]"===Object.prototype.toString.call(a)},k=function(a){return void 0===a||null===a};b.Class=i,b.clone=c,b.defineClass=h,b.expose=d,b.extend=e,b.extendClass=f,b.isArray=j,b.isNone=k}),define("orbit/lib/strings",["exports"],function(a){"use strict";var b=function(a){return a.charAt(0).toUpperCase()+a.slice(1)};a.capitalize=b}),define("orbit/lib/stubs",["exports"],function(a){"use strict";var b=function(){},c=function(){throw new Error("Missing implementation")};a.noop=b,a.required=c}),define("orbit/lib/uuid",["exports"],function(a){"use strict";for(var b=[],c=0;256>c;c++)b[c]=(16>c?"0":"")+c.toString(16);var d=function(){var a=4294967295*Math.random()|0,c=4294967295*Math.random()|0,d=4294967295*Math.random()|0,e=4294967295*Math.random()|0;return b[255&a]+b[a>>8&255]+b[a>>16&255]+b[a>>24&255]+"-"+b[255&c]+b[c>>8&255]+"-"+b[c>>16&15|64]+b[c>>24&255]+"-"+b[63&d|128]+b[d>>8&255]+"-"+b[d>>16&255]+b[d>>24&255]+b[255&e]+b[e>>8&255]+b[e>>16&255]+b[e>>24&255]};a.uuid=d}),define("orbit/main",["exports"],function(a){"use strict";Array.prototype.forEach||(Array.prototype.forEach=function(a,b){var c,d;for(c=0,d=this.length;d>c;++c)c in this&&a.call(b,this[c],c,this)});var b={};a["default"]=b}),define("orbit/notifier",["./lib/objects","exports"],function(a,b){"use strict";var c=a.Class,d=c.extend({init:function(){this.listeners=[]},addListener:function(a,b){b=b||this,this.listeners.push([a,b])},removeListener:function(a,b){var c,d=this.listeners;b=b||this;for(var e=0,f=d.length;f>e;e++)if(c=d[e],c&&c[0]===a&&c[1]===b)return void d.splice(e,1)},emit:function(){var a=arguments;this.listeners.slice(0).forEach(function(b){b[0].apply(b[1],a)})},poll:function(){var a,b=arguments,c=[];return this.listeners.slice(0).forEach(function(d){a=d[0].apply(d[1],b),void 0!==a&&c.push(a)}),c}});b["default"]=d}),define("orbit/request-connector",["./requestable","./lib/assert","./lib/config","./lib/objects","./lib/strings","exports"],function(a,b,c,d,e,f){"use strict";var g=a["default"],h=b.assert,i=c.arrayToOptions,j=d.Class,k=e.capitalize,l=j.extend({init:function(a,b,c){this.primarySource=a,this.secondarySource=b,c=c||{},this.actions=c.actions||g.defaultActions,c.types&&(this.types=i(c.types)),this.mode=void 0!==c.mode?c.mode:"rescue",h("`mode` must be 'assist' or 'rescue'","assist"===this.mode||"rescue"===this.mode);var d=void 0!==c.active?c.active:!0;d&&this.activate()},activate:function(){var a,b=this;this._active||(this.handlers={},this.actions.forEach(function(c){a=b.types?function(a){return b.types[a]?b.secondarySource[c].apply(b.secondarySource,arguments):void 0}:b.secondarySource[c],b.primarySource.on(b.mode+k(c),a,b.secondarySource),b.handlers[c]=a}),this._active=!0)},deactivate:function(){var a=this;this.actions.forEach(function(b){this.primarySource.off(a.mode+k(b),a.handlers[b],a.secondarySource)}),this._active=!1},isActive:function(){return this._active}});f["default"]=l}),define("orbit/requestable",["./evented","./lib/assert","./lib/objects","./lib/strings","exports"],function(a,b,c,d,e){"use strict";var f=a["default"],g=b.assert,h=c.isArray,i=d.capitalize,j={defaultActions:["find"],extend:function(a,b){return void 0===a._requestable&&(a._requestable=!0,f.extend(a),this.defineAction(a,b||this.defaultActions)),a},defineAction:function(a,b){h(b)?b.forEach(function(b){this.defineAction(a,b)},this):a[b]=function(){g("_"+b+" must be defined",a["_"+b]);var c=Array.prototype.slice.call(arguments,0),d=i(b);return a.resolve.apply(a,["assist"+d].concat(c)).then(void 0,function(){return a["_"+b].apply(a,c)}).then(void 0,function(b){return a.resolve.apply(a,["rescue"+d].concat(c)).then(void 0,function(){throw b})}).then(function(b){return c.unshift("did"+d),c.push(b),a.settle.apply(a,c).then(function(){return b})},function(b){return c.unshift("didNot"+d),c.push(b),a.settle.apply(a,c).then(function(){throw b})})}}};e["default"]=j}),define("orbit/transaction",["./lib/objects","exports"],function(a,b){"use strict";var c=a.Class,d=c.extend({init:function(a,b){this.source=a,b=b||{};var c=void 0!==b.active?b.active:!0;c&&this.begin()},begin:function(){this.ops=[],this.inverseOps=[],this._activate()},commit:function(){this._deactivate()},rollback:function(){return this._deactivate(),this.source.transform(this.inverseOps)},_activate:function(){this.source.on("didTransform",this._processTransform,this),this.active=!0},_deactivate:function(){this.source.off("didTransform",this._processTransform,this),this.active=!1},_processTransform:function(a,b){this.ops.push(a),this.inverseOps.push.apply(this.inverseOps,b)}});b["default"]=d}),define("orbit/transform-connector",["./action-queue","./lib/objects","./lib/diffs","./lib/eq","./lib/config","exports"],function(a,b,c,d,e,f){"use strict";var g=a["default"],h=b.Class,i=(b.clone,c.diffs),j=d.eq,k=(e.arrayToOptions,h.extend({init:function(a,b,c){this.source=a,this.target=b,this.transformQueue=new g(this.transform,this,{autoProcess:!1}),c=c||{},this.blocking=void 0!==c.blocking?c.blocking:!0;var d=void 0!==c.active?c.active:!0;d&&this.activate()},activate:function(){this._active||(this.source.on("didTransform",this._processTransform,this),this.target.transformQueue.on("didComplete",this.transformQueue.process,this.transformQueue),this._active=!0)},deactivate:function(){this.source.off("didTransform",this._processTransform,this),this.target.transformQueue.off("didComplete",this.transformQueue.process,this.transformQueue),this._active=!1},isActive:function(){return this._active},transform:function(a){if(this.target.retrieve){var b=this.target.retrieve(a.path);if(null!==b){if("add"===a.op||"replace"===a.op)return j(b,a.value)?void 0:this.resolveConflicts(a.path,b,a.value)}else if("remove"===a.op)return}return this.target.transform(a)},resolveConflicts:function(a,b,c){var d=i(b,c,{basePath:a});return this.target.transform(d)},filterFunction:null,_processTransform:function(a){return!this.filterFunction||this.filterFunction(a)?this.blocking?this._applyOrQueueTransform(a):void this._applyOrQueueTransform(a):void 0},_applyOrQueueTransform:function(a){return this.target.transformQueue.processing?this.transformQueue.push(a):this.transform(a)}}));f["default"]=k}),define("orbit/transformable",["./main","./evented","./action-queue","./lib/assert","./lib/objects","exports"],function(a,b,c,d,e,f){"use strict";var g=a["default"],h=b["default"],i=c["default"],j=d.assert,k=e.isArray,l=function(a){"string"==typeof a.path&&(a.path=a.path.split("/"))},m=function(a){var b=this;return new g.Promise(function(c){var d=function(){if(0===a.length)c();else{var e=a.shift(),f=b.settle.call(b,"didTransform",e[0],e[1]);if(f)return f.then(function(){d()},function(){d()});d()}};d()})},n=function(a){var b=this;return l(a),b.transformQueue.push(a).then(function(a){return b._completedTransforms.length>0?m.call(b,b._completedTransforms).then(function(){return a}):a})},o=function(a){var b,c=this,d=[];return a.forEach(function(a){l(a),b=c.transformQueue.push(a).then(function(a){return c._completedTransforms.length>0?m.call(c,c._completedTransforms).then(function(){d=d.concat(a)}):void(d=d.concat(a))})}),b.then(function(){return d})},p={extend:function(a){return void 0===a._transformable&&(a._transformable=!0,a.transformQueue=new i(a._transform,a),a._completedTransforms=[],h.extend(a),a.didTransform=function(b,c){a._completedTransforms.push([b,c])},a.settleTransforms=function(){return m.call(a,a._completedTransforms)},a.transform=function(b){return j("_transform must be defined",a._transform),k(b)?o.call(a,b):n.call(a,b)}),a}};f["default"]=p});